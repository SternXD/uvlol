{"version":3,"file":"BareClient.js","sources":["../src/snapshot.ts","../src/BareTypes.ts","../src/Client.ts","../src/encodeProtocol.ts","../src/V1.ts","../src/md5.ts","../src/splitHeaderUtil.ts","../src/V2.ts","../src/BareClient.ts"],"sourcesContent":["// The user likely has overwritten all networking functions after importing bare-client\n// It is our responsibility to make sure components of Bare-Client are using native networking functions\n\n// These exports are provided to plugins by @rollup/plugin-inject\n\nexport const fetch = globalThis.fetch;\nexport const WebSocket = globalThis.WebSocket;\nexport const Request = globalThis.Request;\nexport const Response = globalThis.Response;\nexport const XMLHttpRequest = globalThis.XMLHttpRequest;\n","export type BareMethod =\n\t| 'GET'\n\t| 'POST'\n\t| 'DELETE'\n\t| 'OPTIONS'\n\t| 'PUT'\n\t| 'PATCH'\n\t| 'UPDATE'\n\t| string;\n\nexport type BareCache =\n\t| 'default'\n\t| 'no-store'\n\t| 'reload'\n\t| 'no-cache'\n\t| 'force-cache'\n\t| 'only-if-cached'\n\t| string;\n\nexport interface XBare {\n\tstatus?: number;\n\tstatusText?: string;\n\theaders?: Headers;\n\trawHeaders?: BareHeaders;\n}\n\nexport type BareHTTPProtocol = 'blob:' | 'http:' | 'https:' | string;\nexport type BareWSProtocol = 'ws:' | 'wss:' | string;\n\nexport type urlLike = URL | string;\n\nexport const maxRedirects = 20;\n\nexport type BareHeaders = { [key: string]: string | string[] };\n\n/**\n * WebSocket with an additional property.\n */\nexport type BareWebSocket = WebSocket & { meta: Promise<XBare> };\n\n/**\n * A Response with additional properties.\n */\nexport type BareResponse = Response & {\n\trawResponse: Response;\n\trawHeaders: BareHeaders;\n};\n\n/**\n * A BareResponse with additional properties.\n */\nexport type BareResponseFetch = BareResponse & { finalURL: string };\nexport type BareBodyInit =\n\t| Blob\n\t| BufferSource\n\t| FormData\n\t| URLSearchParams\n\t| ReadableStream\n\t| undefined\n\t| null;\n\nexport type BareFetchInit = {\n\tmethod?: BareMethod;\n\theaders?: Headers | BareHeaders;\n\tbody?: BareBodyInit;\n\tcache?: BareCache;\n\tredirect?: 'follow' | 'manual' | 'error' | string;\n\tsignal?: AbortSignal;\n};\n\nexport type BareMaintainer = {\n\temail?: string;\n\twebsite?: string;\n};\n\nexport type BareProject = {\n\tname?: string;\n\tdescription?: string;\n\temail?: string;\n\twebsite?: string;\n\trepository?: string;\n\tversion?: string;\n};\n\nexport type BareLanguage =\n\t| 'NodeJS'\n\t| 'ServiceWorker'\n\t| 'Deno'\n\t| 'Java'\n\t| 'PHP'\n\t| 'Rust'\n\t| 'C'\n\t| 'C++'\n\t| 'C#'\n\t| 'Ruby'\n\t| 'Go'\n\t| 'Crystal'\n\t| 'Shell'\n\t| string;\n\nexport type BareManifest = {\n\tmaintainer?: BareMaintainer;\n\tproject?: BareProject;\n\tversions: string[];\n\tlanguage: BareLanguage;\n\tmemoryUsage?: number;\n};\n","import type {\n\tBareBodyInit,\n\tBareCache,\n\tBareHeaders,\n\tBareHTTPProtocol,\n\tBareMethod,\n\tBareResponse,\n\tBareWebSocket,\n\tBareWSProtocol,\n} from './BareTypes.js';\n\nexport const statusEmpty = [101, 204, 205, 304];\nexport const statusRedirect = [301, 302, 303, 307, 308];\n\nexport interface BareErrorBody {\n\tcode: string;\n\tid: string;\n\tmessage?: string;\n\tstack?: string;\n}\n\nexport class BareError extends Error {\n\tstatus: number;\n\tbody: BareErrorBody;\n\tconstructor(status: number, body: BareErrorBody) {\n\t\tsuper(body.message || body.code);\n\t\tthis.status = status;\n\t\tthis.body = body;\n\t}\n}\n\nexport interface GenericClient {\n\tconnect(\n\t\trequestHeaders: BareHeaders,\n\t\tprotocol: BareWSProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string\n\t): Promise<BareWebSocket>;\n\trequest(\n\t\tmethod: BareMethod,\n\t\trequestHeaders: BareHeaders,\n\t\tbody: BareBodyInit,\n\t\tprotocol: BareHTTPProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string,\n\t\tcache: BareCache | undefined,\n\t\tsignal: AbortSignal | undefined\n\t): Promise<BareResponse>;\n}\n\nexport default class Client {\n\tprotected base: URL;\n\t/**\n\t *\n\t * @param version Version provided by extension\n\t * @param server Bare Server URL provided by BareClient\n\t */\n\tconstructor(version: number, server: URL) {\n\t\tthis.base = new URL(`./v${version}/`, server);\n\t}\n}\n","const validChars =\n\t\"!#$%&'*+-.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ^_`abcdefghijklmnopqrstuvwxyz|~\";\nconst reserveChar = '%';\n\nexport function validProtocol(protocol: string): boolean {\n\tfor (let i = 0; i < protocol.length; i++) {\n\t\tconst char = protocol[i];\n\n\t\tif (!validChars.includes(char)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nexport function encodeProtocol(protocol: string): string {\n\tlet result = '';\n\n\tfor (let i = 0; i < protocol.length; i++) {\n\t\tconst char = protocol[i];\n\n\t\tif (validChars.includes(char) && char !== reserveChar) {\n\t\t\tresult += char;\n\t\t} else {\n\t\t\tconst code = char.charCodeAt(0);\n\t\t\tresult += reserveChar + code.toString(16).padStart(2, '0');\n\t\t}\n\t}\n\n\treturn result;\n}\n\nexport function decodeProtocol(protocol: string): string {\n\tlet result = '';\n\n\tfor (let i = 0; i < protocol.length; i++) {\n\t\tconst char = protocol[i];\n\n\t\tif (char === reserveChar) {\n\t\t\tconst code = parseInt(protocol.slice(i + 1, i + 3), 16);\n\t\t\tconst decoded = String.fromCharCode(code);\n\n\t\t\tresult += decoded;\n\t\t\ti += 2;\n\t\t} else {\n\t\t\tresult += char;\n\t\t}\n\t}\n\n\treturn result;\n}\n","import type {\n\tBareBodyInit,\n\tBareCache,\n\tBareHeaders,\n\tBareHTTPProtocol,\n\tBareMethod,\n\tBareResponse,\n\tBareWebSocket,\n\tBareWSProtocol,\n\tXBare,\n} from './BareTypes';\nimport type { GenericClient } from './Client';\nimport Client, { BareError, statusEmpty } from './Client';\nimport { encodeProtocol } from './encodeProtocol';\n\nexport default class ClientV1 extends Client implements GenericClient {\n\tws: URL;\n\thttp: URL;\n\tnewMeta: URL;\n\tgetMeta: URL;\n\tconstructor(server: URL) {\n\t\tsuper(1, server);\n\n\t\tthis.ws = new URL(this.base);\n\t\tthis.http = new URL(this.base);\n\t\tthis.newMeta = new URL('ws-new-meta', this.base);\n\t\tthis.getMeta = new URL('ws-meta', this.base);\n\n\t\tif (this.ws.protocol === 'https:') {\n\t\t\tthis.ws.protocol = 'wss:';\n\t\t} else {\n\t\t\tthis.ws.protocol = 'ws:';\n\t\t}\n\t}\n\tasync connect(\n\t\trequestHeaders: BareHeaders,\n\t\tprotocol: BareWSProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string\n\t): Promise<BareWebSocket> {\n\t\tconst assignMeta = await fetch(this.newMeta, { method: 'GET' });\n\n\t\tif (!assignMeta.ok) {\n\t\t\tthrow new BareError(assignMeta.status, await assignMeta.json());\n\t\t}\n\n\t\tconst id = await assignMeta.text();\n\n\t\tconst socket: WebSocket & Partial<BareWebSocket> = new WebSocket(this.ws, [\n\t\t\t'bare',\n\t\t\tencodeProtocol(\n\t\t\t\tJSON.stringify({\n\t\t\t\t\tremote: {\n\t\t\t\t\t\tprotocol,\n\t\t\t\t\t\thost,\n\t\t\t\t\t\tport,\n\t\t\t\t\t\tpath,\n\t\t\t\t\t},\n\t\t\t\t\theaders: requestHeaders,\n\t\t\t\t\tforward_headers: [\n\t\t\t\t\t\t'accept-encoding',\n\t\t\t\t\t\t'accept-language',\n\t\t\t\t\t\t'sec-websocket-extensions',\n\t\t\t\t\t\t'sec-websocket-key',\n\t\t\t\t\t\t'sec-websocket-version',\n\t\t\t\t\t],\n\t\t\t\t\tid,\n\t\t\t\t})\n\t\t\t),\n\t\t]);\n\n\t\tsocket.meta = new Promise<XBare>((resolve, reject) => {\n\t\t\tsocket.addEventListener('open', async () => {\n\t\t\t\tconst outgoing = await fetch(this.getMeta, {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'x-bare-id': id,\n\t\t\t\t\t},\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t});\n\n\t\t\t\tif (!outgoing.ok) {\n\t\t\t\t\treject(new BareError(outgoing.status, await outgoing.json()));\n\t\t\t\t}\n\n\t\t\t\tresolve(await outgoing.json());\n\t\t\t});\n\n\t\t\tsocket.addEventListener('error', reject);\n\t\t});\n\n\t\treturn <BareWebSocket>socket;\n\t}\n\tasync request(\n\t\tmethod: BareMethod,\n\t\trequestHeaders: BareHeaders,\n\t\tbody: BareBodyInit,\n\t\tprotocol: BareHTTPProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string,\n\t\tcache: BareCache | undefined,\n\t\tsignal: AbortSignal | undefined\n\t): Promise<BareResponse> {\n\t\tif (protocol.startsWith('blob:')) {\n\t\t\tconst response = await fetch(`${protocol}${host}${path}`);\n\t\t\tconst result: Response & Partial<BareResponse> = new Response(\n\t\t\t\tresponse.body,\n\t\t\t\tresponse\n\t\t\t);\n\n\t\t\tresult.rawHeaders = Object.fromEntries(response.headers);\n\t\t\tresult.rawResponse = response;\n\n\t\t\treturn <BareResponse>result;\n\t\t}\n\n\t\tconst bareHeaders: BareHeaders = {};\n\n\t\tif (requestHeaders instanceof Headers) {\n\t\t\tfor (const [header, value] of requestHeaders) {\n\t\t\t\tbareHeaders[header] = value;\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const header in requestHeaders) {\n\t\t\t\tbareHeaders[header] = requestHeaders[header];\n\t\t\t}\n\t\t}\n\n\t\tconst forwardHeaders = ['accept-encoding', 'accept-language'];\n\n\t\tconst options: RequestInit = {\n\t\t\tcredentials: 'omit',\n\t\t\tmethod: method,\n\t\t\tsignal,\n\t\t};\n\n\t\tif (body !== undefined) {\n\t\t\toptions.body = body;\n\t\t}\n\n\t\t// bare can be an absolute path containing no origin, it becomes relative to the script\n\t\tconst request = new Request(this.http, options);\n\n\t\tthis.writeBareRequest(\n\t\t\trequest,\n\t\t\tprotocol,\n\t\t\thost,\n\t\t\tpath,\n\t\t\tport,\n\t\t\tbareHeaders,\n\t\t\tforwardHeaders\n\t\t);\n\n\t\tconst response = await fetch(request);\n\n\t\tconst readResponse = await this.readBareResponse(response);\n\n\t\tconst result: Partial<BareResponse> = new Response(\n\t\t\tstatusEmpty.includes(readResponse.status) ? undefined : response.body,\n\t\t\t{\n\t\t\t\tstatus: readResponse.status,\n\t\t\t\tstatusText: readResponse.statusText ?? undefined,\n\t\t\t\theaders: readResponse.headers,\n\t\t\t}\n\t\t);\n\n\t\tresult.rawHeaders = readResponse.rawHeaders;\n\t\tresult.rawResponse = response;\n\n\t\treturn <BareResponse>result;\n\t}\n\tprivate async readBareResponse(response: Response) {\n\t\tif (!response.ok) {\n\t\t\tthrow new BareError(response.status, await response.json());\n\t\t}\n\n\t\tconst requiredHeaders = [\n\t\t\t'x-bare-status',\n\t\t\t'x-bare-status-text',\n\t\t\t'x-bare-headers',\n\t\t];\n\n\t\tfor (const header of requiredHeaders) {\n\t\t\tif (!response.headers.has(header)) {\n\t\t\t\tthrow new BareError(500, {\n\t\t\t\t\tcode: 'IMPL_MISSING_BARE_HEADER',\n\t\t\t\t\tid: `response.headers.${header}`,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst status = parseInt(response.headers.get('x-bare-status')!);\n\t\tconst statusText = response.headers.get('x-bare-status-text')!;\n\t\tconst rawHeaders = JSON.parse(response.headers.get('x-bare-headers')!);\n\t\tconst headers = new Headers(rawHeaders);\n\n\t\treturn {\n\t\t\tstatus,\n\t\t\tstatusText,\n\t\t\trawHeaders,\n\t\t\theaders,\n\t\t};\n\t}\n\tprivate writeBareRequest(\n\t\trequest: Request,\n\t\tprotocol: BareHTTPProtocol,\n\t\thost: string,\n\t\tpath: string,\n\t\tport: string | number,\n\t\tbareHeaders: BareHeaders,\n\t\tforwardHeaders: string[]\n\t) {\n\t\trequest.headers.set('x-bare-protocol', protocol);\n\t\trequest.headers.set('x-bare-host', host);\n\t\trequest.headers.set('x-bare-path', path);\n\t\trequest.headers.set('x-bare-port', port.toString());\n\t\trequest.headers.set('x-bare-headers', JSON.stringify(bareHeaders));\n\t\trequest.headers.set(\n\t\t\t'x-bare-forward-headers',\n\t\t\tJSON.stringify(forwardHeaders)\n\t\t);\n\t}\n}\n","/*\n * JavaScript MD5\n * Adopted from https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\n\n/**\n * Add integers, wrapping at 2^32.\n * This uses 16-bit operations internally to work around bugs in interpreters.\n *\n * @param x First integer\n * @param y Second integer\n * @returns Sum\n */\nfunction safeAdd(x: number, y: number): number {\n\tconst lsw = (x & 0xffff) + (y & 0xffff);\n\tconst msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n\treturn (msw << 16) | (lsw & 0xffff);\n}\n\n/**\n * Bitwise rotate a 32-bit number to the left.\n *\n * @param num 32-bit number\n * @param cnt Rotation count\n * @returns  Rotated number\n */\nfunction bitRotateLeft(num: number, cnt: number): number {\n\treturn (num << cnt) | (num >>> (32 - cnt));\n}\n\n/**\n * Basic operation the algorithm uses.\n *\n * @param q q\n * @param a a\n * @param b b\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5cmn(\n\tq: number,\n\ta: number,\n\tb: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5ff(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn((b & c) | (~b & d), a, b, x, s, t);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5gg(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn((b & d) | (c & ~d), a, b, x, s, t);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5hh(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5ii(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n\n/**\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n *\n * @param x Array of little-endian words\n * @param len Bit length\n * @returns MD5 Array\n */\nfunction binlMD5(x: number[], len: number): number[] {\n\t/* append padding */\n\tx[len >> 5] |= 0x80 << len % 32;\n\tx[(((len + 64) >>> 9) << 4) + 14] = len;\n\n\tlet a = 1732584193;\n\tlet b = -271733879;\n\tlet c = -1732584194;\n\tlet d = 271733878;\n\n\tfor (let i = 0; i < x.length; i += 16) {\n\t\tconst olda = a;\n\t\tconst oldb = b;\n\t\tconst oldc = c;\n\t\tconst oldd = d;\n\n\t\ta = md5ff(a, b, c, d, x[i], 7, -680876936);\n\t\td = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n\t\tc = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n\t\tb = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n\t\ta = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n\t\td = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n\t\tc = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n\t\tb = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n\t\ta = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n\t\td = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n\t\tc = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n\t\tb = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n\t\ta = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n\t\td = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n\t\tc = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n\t\tb = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n\n\t\ta = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n\t\td = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n\t\tc = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n\t\tb = md5gg(b, c, d, a, x[i], 20, -373897302);\n\t\ta = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n\t\td = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n\t\tc = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n\t\tb = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n\t\ta = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n\t\td = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n\t\tc = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n\t\tb = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n\t\ta = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n\t\td = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n\t\tc = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n\t\tb = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n\n\t\ta = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n\t\td = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n\t\tc = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n\t\tb = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n\t\ta = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n\t\td = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n\t\tc = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n\t\tb = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n\t\ta = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n\t\td = md5hh(d, a, b, c, x[i], 11, -358537222);\n\t\tc = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n\t\tb = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n\t\ta = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n\t\td = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n\t\tc = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n\t\tb = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n\n\t\ta = md5ii(a, b, c, d, x[i], 6, -198630844);\n\t\td = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n\t\tc = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n\t\tb = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n\t\ta = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n\t\td = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n\t\tc = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n\t\tb = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n\t\ta = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n\t\td = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n\t\tc = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n\t\tb = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n\t\ta = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n\t\td = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n\t\tc = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n\t\tb = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n\n\t\ta = safeAdd(a, olda);\n\t\tb = safeAdd(b, oldb);\n\t\tc = safeAdd(c, oldc);\n\t\td = safeAdd(d, oldd);\n\t}\n\treturn [a, b, c, d];\n}\n\n/**\n * Convert an array of little-endian words to a string\n *\n * @param input MD5 Array\n * @returns MD5 string\n */\nfunction binl2rstr(input: number[]): string {\n\tlet output = '';\n\tconst length32 = input.length * 32;\n\tfor (let i = 0; i < length32; i += 8) {\n\t\toutput += String.fromCharCode((input[i >> 5] >>> i % 32) & 0xff);\n\t}\n\treturn output;\n}\n\n/**\n * Convert a raw string to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n *\n * @param input Raw input string\n * @returns Array of little-endian words\n */\nfunction rstr2binl(input: string): number[] {\n\tconst output: number[] = [];\n\tconst outputLen = input.length >> 2;\n\tfor (let i = 0; i < outputLen; i += 1) {\n\t\toutput[i] = 0;\n\t}\n\tconst length8 = input.length * 8;\n\tfor (let i = 0; i < length8; i += 8) {\n\t\toutput[i >> 5]! |= (input.charCodeAt(i / 8) & 0xff) << i % 32;\n\t}\n\treturn <number[]>output;\n}\n\n/**\n * Calculate the MD5 of a raw string\n *\n * @param s Input string\n * @returns Raw MD5 string\n */\nfunction rstrMD5(s: string): string {\n\treturn binl2rstr(binlMD5(rstr2binl(s), s.length * 8));\n}\n\n/**\n * Calculates the HMAC-MD5 of a key and some data (raw strings)\n *\n * @param key HMAC key\n * @param data Raw input string\n * @returns Raw MD5 string\n */\nfunction rstrHMACMD5(key: string, data: string): string {\n\tlet bkey = rstr2binl(key);\n\tconst ipad: number[] = [];\n\tconst opad: number[] = [];\n\tif (bkey.length > 16) {\n\t\tbkey = binlMD5(bkey, key.length * 8);\n\t}\n\tfor (let i = 0; i < 16; i += 1) {\n\t\tipad[i] = bkey[i] ^ 0x36363636;\n\t\topad[i] = bkey[i] ^ 0x5c5c5c5c;\n\t}\n\tconst hash = binlMD5(ipad.concat(rstr2binl(data)), 512 + data.length * 8);\n\treturn binl2rstr(binlMD5(opad.concat(hash), 512 + 128));\n}\n\n/**\n * Convert a raw string to a hex string\n *\n * @param input Raw input string\n * @returns Hex encoded string\n */\nfunction rstr2hex(input: string): string {\n\tconst hexTab = '0123456789abcdef';\n\tlet output = '';\n\tfor (let i = 0; i < input.length; i += 1) {\n\t\tconst x = input.charCodeAt(i);\n\t\toutput += hexTab.charAt((x >>> 4) & 0x0f) + hexTab.charAt(x & 0x0f);\n\t}\n\treturn output;\n}\n\n/**\n * Encode a string as UTF-8\n *\n * @param input Input string\n * @returns UTF8 string\n */\nfunction str2rstrUTF8(input: string): string {\n\treturn unescape(encodeURIComponent(input));\n}\n\n/**\n * Encodes input string as raw MD5 string\n *\n * @param s Input string\n * @returns Raw MD5 string\n */\nfunction rawMD5(s: string): string {\n\treturn rstrMD5(str2rstrUTF8(s));\n}\n/**\n * Encodes input string as Hex encoded string\n *\n * @param s Input string\n * @returns Hex encoded string\n */\nfunction hexMD5(s: string): string {\n\treturn rstr2hex(rawMD5(s));\n}\n/**\n * Calculates the raw HMAC-MD5 for the given key and data\n *\n * @param k HMAC key\n * @param d Input string\n * @returns Raw MD5 string\n */\nfunction rawHMACMD5(k: string, d: string): string {\n\treturn rstrHMACMD5(str2rstrUTF8(k), str2rstrUTF8(d));\n}\n/**\n * Calculates the Hex encoded HMAC-MD5 for the given key and data\n *\n * @param k HMAC key\n * @param d Input string\n * @returns Raw MD5 string\n */\nfunction hexHMACMD5(k: string, d: string): string {\n\treturn rstr2hex(rawHMACMD5(k, d));\n}\n\n/**\n * Calculates MD5 value for a given string.\n * If a key is provided, calculates the HMAC-MD5 value.\n * Returns a Hex encoded string unless the raw argument is given.\n *\n * @param string Input string\n * @param key HMAC key\n * @param raw Raw output switch\n * @returns MD5 output\n */\nexport default function md5(\n\tstring: string,\n\tkey?: string,\n\traw?: boolean\n): string {\n\tif (!key) {\n\t\tif (!raw) {\n\t\t\treturn hexMD5(string);\n\t\t}\n\t\treturn rawMD5(string);\n\t}\n\tif (!raw) {\n\t\treturn hexHMACMD5(key, string);\n\t}\n\treturn rawHMACMD5(key, string);\n}\n","import { BareError } from './Client';\n\nconst MAX_HEADER_VALUE = 3072;\n\n/**\n *\n * Splits headers according to spec\n * @param headers\n * @returns Split headers\n */\nexport function splitHeaders(headers: Headers): Headers {\n\tconst output = new Headers(headers);\n\n\tif (headers.has('x-bare-headers')) {\n\t\tconst value = headers.get('x-bare-headers')!;\n\n\t\tif (value.length > MAX_HEADER_VALUE) {\n\t\t\toutput.delete('x-bare-headers');\n\n\t\t\tlet split = 0;\n\n\t\t\tfor (let i = 0; i < value.length; i += MAX_HEADER_VALUE) {\n\t\t\t\tconst part = value.slice(i, i + MAX_HEADER_VALUE);\n\n\t\t\t\tconst id = split++;\n\t\t\t\toutput.set(`x-bare-headers-${id}`, `;${part}`);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn output;\n}\n\n/**\n * Joins headers according to spec\n * @param headers\n * @returns Joined headers\n */\nexport function joinHeaders(headers: Headers): Headers {\n\tconst output = new Headers(headers);\n\n\tconst prefix = 'x-bare-headers';\n\n\tif (headers.has(`${prefix}-0`)) {\n\t\tconst join: string[] = [];\n\n\t\tfor (const [header, value] of headers) {\n\t\t\tif (!header.startsWith(prefix)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!value.startsWith(';')) {\n\t\t\t\tthrow new BareError(400, {\n\t\t\t\t\tcode: 'INVALID_BARE_HEADER',\n\t\t\t\t\tid: `request.headers.${header}`,\n\t\t\t\t\tmessage: `Value didn't begin with semi-colon.`,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst id = parseInt(header.slice(prefix.length + 1));\n\n\t\t\tjoin[id] = value.slice(1);\n\n\t\t\toutput.delete(header);\n\t\t}\n\n\t\toutput.set(prefix, join.join(''));\n\t}\n\n\treturn output;\n}\n","import type {\n\tBareBodyInit,\n\tBareCache,\n\tBareHeaders,\n\tBareHTTPProtocol,\n\tBareMethod,\n\tBareResponse,\n\tBareWebSocket,\n\tBareWSProtocol,\n\tXBare,\n} from './BareTypes.js';\nimport Client, { BareError, statusEmpty } from './Client.js';\nimport type { GenericClient } from './Client.js';\nimport md5 from './md5.js';\nimport { joinHeaders, splitHeaders } from './splitHeaderUtil.js';\n\nexport default class ClientV2 extends Client implements GenericClient {\n\tws: URL;\n\thttp: URL;\n\tnewMeta: URL;\n\tgetMeta: URL;\n\tconstructor(server: URL) {\n\t\tsuper(2, server);\n\n\t\tthis.ws = new URL(this.base);\n\t\tthis.http = new URL(this.base);\n\t\tthis.newMeta = new URL('./ws-new-meta', this.base);\n\t\tthis.getMeta = new URL(`./ws-meta`, this.base);\n\n\t\tif (this.ws.protocol === 'https:') {\n\t\t\tthis.ws.protocol = 'wss:';\n\t\t} else {\n\t\t\tthis.ws.protocol = 'ws:';\n\t\t}\n\t}\n\tasync connect(\n\t\trequestHeaders: BareHeaders,\n\t\tprotocol: BareWSProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string\n\t): Promise<BareWebSocket> {\n\t\tconst request = new Request(this.newMeta, {\n\t\t\theaders: this.createBareHeaders(\n\t\t\t\tprotocol,\n\t\t\t\thost,\n\t\t\t\tpath,\n\t\t\t\tport,\n\t\t\t\trequestHeaders\n\t\t\t),\n\t\t});\n\n\t\tconst assignMeta = await fetch(request);\n\n\t\tif (!assignMeta.ok) {\n\t\t\tthrow new BareError(assignMeta.status, await assignMeta.json());\n\t\t}\n\n\t\tconst id = await assignMeta.text();\n\n\t\tconst socket: WebSocket & Partial<BareWebSocket> = new WebSocket(this.ws, [\n\t\t\tid,\n\t\t]);\n\n\t\tsocket.meta = new Promise<XBare>((resolve, reject) => {\n\t\t\tsocket.addEventListener('open', async () => {\n\t\t\t\tconst outgoing = await fetch(this.getMeta, {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'x-bare-id': id,\n\t\t\t\t\t},\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t});\n\n\t\t\t\tresolve(await this.readBareResponse(outgoing));\n\t\t\t});\n\n\t\t\tsocket.addEventListener('error', reject);\n\t\t});\n\n\t\treturn <BareWebSocket>socket;\n\t}\n\tasync request(\n\t\tmethod: BareMethod,\n\t\trequestHeaders: BareHeaders,\n\t\tbody: BareBodyInit,\n\t\tprotocol: BareHTTPProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string,\n\t\tcache: BareCache | undefined,\n\t\tsignal: AbortSignal | undefined\n\t): Promise<BareResponse> {\n\t\tif (protocol.startsWith('blob:')) {\n\t\t\tconst response = await fetch(`${protocol}${host}${path}`);\n\t\t\tconst result: Response & Partial<BareResponse> = new Response(\n\t\t\t\tresponse.body,\n\t\t\t\tresponse\n\t\t\t);\n\n\t\t\tresult.rawHeaders = Object.fromEntries(response.headers);\n\t\t\tresult.rawResponse = response;\n\n\t\t\treturn <BareResponse>result;\n\t\t}\n\n\t\tconst bareHeaders: BareHeaders = {};\n\n\t\tif (requestHeaders instanceof Headers) {\n\t\t\tfor (const [header, value] of requestHeaders) {\n\t\t\t\tbareHeaders[header] = value;\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const header in requestHeaders) {\n\t\t\t\tbareHeaders[header] = requestHeaders[header];\n\t\t\t}\n\t\t}\n\n\t\tconst options: RequestInit = {\n\t\t\tcredentials: 'omit',\n\t\t\tmethod: method,\n\t\t\tsignal,\n\t\t};\n\n\t\tif (cache !== 'only-if-cached') {\n\t\t\toptions.cache = <RequestCache>cache;\n\t\t}\n\n\t\tif (body !== undefined) {\n\t\t\toptions.body = body;\n\t\t}\n\n\t\toptions.headers = this.createBareHeaders(\n\t\t\tprotocol,\n\t\t\thost,\n\t\t\tpath,\n\t\t\tport,\n\t\t\tbareHeaders\n\t\t);\n\n\t\tconst request = new Request(\n\t\t\tthis.http + '?cache=' + md5(`${protocol}${host}${port}${path}`),\n\t\t\toptions\n\t\t);\n\n\t\tconst response = await fetch(request);\n\n\t\tconst readResponse = await this.readBareResponse(response);\n\n\t\tconst result: Response & Partial<BareResponse> = new Response(\n\t\t\tstatusEmpty.includes(readResponse.status!) ? undefined : response.body,\n\t\t\t{\n\t\t\t\tstatus: readResponse.status!,\n\t\t\t\tstatusText: readResponse.statusText ?? undefined,\n\t\t\t\theaders: readResponse.headers!,\n\t\t\t}\n\t\t);\n\n\t\tresult.rawHeaders = readResponse.rawHeaders;\n\t\tresult.rawResponse = response;\n\n\t\treturn <BareResponse>result;\n\t}\n\tprivate async readBareResponse(response: Response): Promise<XBare> {\n\t\tif (!response.ok) {\n\t\t\tthrow new BareError(response.status, await response.json());\n\t\t}\n\n\t\tconst responseHeaders = joinHeaders(response.headers);\n\n\t\tconst result: XBare = {};\n\n\t\tif (responseHeaders.has('x-bare-status')) {\n\t\t\tresult.status = parseInt(responseHeaders.get('x-bare-status')!);\n\t\t}\n\n\t\tif (responseHeaders.has('x-bare-status-text')) {\n\t\t\tresult.statusText = responseHeaders.get('x-bare-status-text')!;\n\t\t}\n\n\t\tif (responseHeaders.has('x-bare-headers')) {\n\t\t\tresult.rawHeaders = JSON.parse(responseHeaders.get('x-bare-headers')!);\n\t\t\tresult.headers = new Headers(<HeadersInit>result.rawHeaders);\n\t\t}\n\n\t\treturn result;\n\t}\n\tcreateBareHeaders(\n\t\tprotocol: BareWSProtocol | BareHTTPProtocol,\n\t\thost: string,\n\t\tpath: string,\n\t\tport: number | string,\n\t\tbareHeaders: BareHeaders,\n\t\tforwardHeaders: string[] = [],\n\t\tpassHeaders: string[] = [],\n\t\tpassStatus: number[] = []\n\t) {\n\t\tconst headers = new Headers();\n\n\t\theaders.set('x-bare-protocol', protocol);\n\t\theaders.set('x-bare-host', host);\n\t\theaders.set('x-bare-path', path);\n\t\theaders.set('x-bare-port', port.toString());\n\t\theaders.set('x-bare-headers', JSON.stringify(bareHeaders));\n\n\t\tfor (const header of forwardHeaders) {\n\t\t\theaders.append('x-bare-forward-headers', header);\n\t\t}\n\n\t\tfor (const header of passHeaders) {\n\t\t\theaders.append('x-bare-pass-headers', header);\n\t\t}\n\n\t\tfor (const status of passStatus) {\n\t\t\theaders.append('x-bare-pass-status', status.toString());\n\t\t}\n\n\t\tsplitHeaders(headers);\n\n\t\treturn headers;\n\t}\n}\n","import type {\n\tBareBodyInit,\n\tBareCache,\n\tBareHeaders,\n\tBareHTTPProtocol,\n\tBareManifest,\n\tBareMethod,\n\tBareResponse,\n\tBareResponseFetch,\n\tBareWebSocket,\n\tBareWSProtocol,\n\turlLike,\n} from './BareTypes';\nimport { maxRedirects } from './BareTypes';\nimport type { GenericClient } from './Client';\nimport { statusRedirect } from './Client';\nimport ClientV1 from './V1';\nimport ClientV2 from './V2';\nimport { validProtocol } from './encodeProtocol';\n\n// Implements the protocol for requesting bare data from a server\n// See ../Server/Send.mjs\n\nexport * from './Client';\n\nconst clientCtors: [string, { new (server: URL): GenericClient }][] = [\n\t['v2', ClientV2],\n\t['v1', ClientV1],\n];\n\nasync function fetchManifest(\n\tserver: string | URL,\n\tsignal?: AbortSignal\n): Promise<BareManifest> {\n\tconst outgoing = await fetch(server, { signal });\n\n\tif (!outgoing.ok) {\n\t\tthrow new Error(\n\t\t\t`Unable to fetch Bare meta: ${outgoing.status} ${await outgoing.text()}`\n\t\t);\n\t}\n\n\treturn await outgoing.json();\n}\n\nfunction resolvePort(url: URL) {\n\tif (url.port) return Number(url.port);\n\n\tswitch (url.protocol) {\n\t\tcase 'ws:':\n\t\tcase 'http:':\n\t\t\treturn 80;\n\t\tcase 'wss:':\n\t\tcase 'https:':\n\t\t\treturn 443;\n\t\tdefault:\n\t\t\t// maybe blob\n\t\t\treturn 0;\n\t}\n}\n\nexport default class BareClient {\n\t/**\n\t * @depricated Use .manifest instead.\n\t */\n\tget data(): BareClient['manfiest'] {\n\t\treturn this.manfiest;\n\t}\n\tmanfiest?: BareManifest;\n\tprivate client?: GenericClient;\n\tprivate server: URL;\n\tprivate working?: Promise<void>;\n\tprivate onDemand: boolean;\n\tprivate onDemandSignal?: AbortSignal;\n\t/**\n\t * Lazily create a BareClient. Calls to fetch and connect will request the manifest once on-demand.\n\t * @param server A full URL to the bare server.\n\t * @param signal An abort signal for fetching the manifest on demand.\n\t */\n\tconstructor(server: string | URL, signal?: AbortSignal);\n\t/**\n\t * Immediately create a BareClient.\n\t * @param server A full URL to the bare server.\n\t * @param manfiest A Bare server manifest.\n\t */\n\tconstructor(server: string | URL, manfiest?: BareManifest);\n\tconstructor(server: string | URL, _?: BareManifest | AbortSignal) {\n\t\tthis.server = new URL(server);\n\n\t\tif (!_ || _ instanceof AbortSignal) {\n\t\t\tthis.onDemand = true;\n\t\t\tthis.onDemandSignal = _;\n\t\t} else {\n\t\t\tthis.onDemand = false;\n\t\t\tthis.manfiest = _;\n\t\t\tthis.getClient();\n\t\t}\n\t}\n\tprivate demand() {\n\t\tif (!this.onDemand) return;\n\n\t\tif (!this.working)\n\t\t\tthis.working = fetchManifest(this.server, this.onDemandSignal)\n\t\t\t\t.then((manfiest) => {\n\t\t\t\t\tthis.manfiest = manfiest;\n\t\t\t\t\tthis.getClient();\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\t// allow the next request to re-fetch the manifest\n\t\t\t\t\t// this is to prevent BareClient from permanently failing when used on demand\n\t\t\t\t\tdelete this.working;\n\t\t\t\t\tthrow err;\n\t\t\t\t});\n\n\t\treturn this.working;\n\t}\n\tprivate getClient() {\n\t\t// newest-oldest\n\t\tfor (const [version, ctor] of clientCtors) {\n\t\t\tif (this.data!.versions.includes(version)) {\n\t\t\t\tthis.client = new ctor(this.server);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(`Unable to find compatible client version.`);\n\t}\n\tasync request(\n\t\tmethod: BareMethod,\n\t\trequestHeaders: BareHeaders,\n\t\tbody: BareBodyInit,\n\t\tprotocol: BareHTTPProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string,\n\t\tcache: BareCache | undefined,\n\t\tsignal: AbortSignal | undefined\n\t): Promise<BareResponse> {\n\t\tawait this.demand();\n\n\t\treturn await this.client!.request(\n\t\t\tmethod,\n\t\t\trequestHeaders,\n\t\t\tbody,\n\t\t\tprotocol,\n\t\t\thost,\n\t\t\tport,\n\t\t\tpath,\n\t\t\tcache,\n\t\t\tsignal\n\t\t);\n\t}\n\tasync connect(\n\t\trequestHeaders: BareHeaders,\n\t\tprotocol: BareWSProtocol,\n\t\thost: string,\n\t\tport: string | number,\n\t\tpath: string\n\t): Promise<BareWebSocket> {\n\t\tawait this.demand();\n\n\t\treturn this.client!.connect(requestHeaders, protocol, host, port, path);\n\t}\n\t/**\n\t *\n\t * @param url\n\t * @param headers\n\t * @param protocols\n\t * @returns\n\t */\n\tcreateWebSocket(\n\t\turl: urlLike,\n\t\theaders: BareHeaders | Headers = {},\n\t\tprotocols: string | string[] = []\n\t): Promise<BareWebSocket> {\n\t\tconst requestHeaders: BareHeaders =\n\t\t\theaders instanceof Headers ? Object.fromEntries(headers) : headers;\n\n\t\turl = new URL(url);\n\n\t\t// user is expected to specify user-agent and origin\n\t\t// both are in spec\n\n\t\trequestHeaders['Host'] = url.host;\n\t\t// requestHeaders['Origin'] = origin;\n\t\trequestHeaders['Pragma'] = 'no-cache';\n\t\trequestHeaders['Cache-Control'] = 'no-cache';\n\t\trequestHeaders['Upgrade'] = 'websocket';\n\t\t// requestHeaders['User-Agent'] = navigator.userAgent;\n\t\trequestHeaders['Connection'] = 'Upgrade';\n\n\t\tif (typeof protocols === 'string') {\n\t\t\tprotocols = [protocols];\n\t\t}\n\n\t\tfor (const proto of protocols) {\n\t\t\tif (!validProtocol(proto)) {\n\t\t\t\tthrow new DOMException(\n\t\t\t\t\t`Failed to construct 'WebSocket': The subprotocol '${proto}' is invalid.`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (protocols.length)\n\t\t\trequestHeaders['Sec-Websocket-Protocol'] = protocols.join(', ');\n\n\t\treturn this.connect(\n\t\t\trequestHeaders,\n\t\t\turl.protocol,\n\t\t\turl.hostname,\n\t\t\tresolvePort(url),\n\t\t\turl.pathname + url.search\n\t\t);\n\t}\n\tasync fetch(\n\t\turl: urlLike | Request,\n\t\tinit?: RequestInit\n\t): Promise<BareResponseFetch> {\n\t\tconst req = isUrlLike(url) ? new Request(url, init) : url;\n\n\t\t/*\n\t\tconst a = new Headers(); // unmanaged `Headers`\n\t\tconst b = new Request(location.toString()).headers; // managed `Headers`\n\n\n\t\ta.set(\"user-agent\", \"test\");\n\t\tb.set(\"user-agent\", \"test\");\n\n\t\t// On Chrome: \"test\" null\n\t\tconsole.log(a.get(\"user-agent\"), b.get(\"user-agent\"))\n\t\t*/\n\n\t\t// try to use init.headers because it may contain capitalized headers\n\t\t// furthermore, important headers on the Request class are blocked...\n\t\t// we should try to preserve the capitalization due to quirks with earlier servers\n\t\tconst inputHeaders = init?.headers || req.headers;\n\n\t\tconst headers: BareHeaders =\n\t\t\tinputHeaders instanceof Headers\n\t\t\t\t? Object.fromEntries(inputHeaders)\n\t\t\t\t: (inputHeaders as BareHeaders);\n\n\t\tlet urlO = new URL(req.url);\n\n\t\tfor (let i = 0; ; i++) {\n\t\t\tif ('host' in headers) headers.host = urlO.host;\n\t\t\telse headers.Host = urlO.host;\n\n\t\t\tconst response: BareResponse & Partial<BareResponseFetch> =\n\t\t\t\tawait this.request(\n\t\t\t\t\treq.method,\n\t\t\t\t\theaders,\n\t\t\t\t\treq.body,\n\t\t\t\t\turlO.protocol,\n\t\t\t\t\turlO.hostname,\n\t\t\t\t\tresolvePort(urlO),\n\t\t\t\t\turlO.pathname + urlO.search,\n\t\t\t\t\treq.cache,\n\t\t\t\t\treq.signal\n\t\t\t\t);\n\n\t\t\tresponse.finalURL = url.toString();\n\n\t\t\tif (statusRedirect.includes(response.status)) {\n\t\t\t\tswitch (req.redirect) {\n\t\t\t\t\tcase 'follow':\n\t\t\t\t\t\tif (maxRedirects > i && response.headers.has('location')) {\n\t\t\t\t\t\t\turlO = new URL(response.headers.get('location')!, urlO);\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow new TypeError('Failed to fetch');\n\t\t\t\t\t\t}\n\t\t\t\t\tcase 'error':\n\t\t\t\t\t\tthrow new TypeError('Failed to fetch');\n\t\t\t\t\tcase 'manual':\n\t\t\t\t\t\treturn <BareResponseFetch>response;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn <BareResponseFetch>response;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction isUrlLike(url: unknown): url is urlLike {\n\treturn typeof url === 'string' || url instanceof URL;\n}\n\n/**\n *\n * Facilitates fetching the Bare server and constructing a BareClient.\n * @param server Bare server\n * @param signal Abort signal when fetching the manifest\n */\nexport async function createBareClient(\n\tserver: string | URL,\n\tsignal?: AbortSignal\n): Promise<BareClient> {\n\tconst manfiest = await fetchManifest(server, signal);\n\n\treturn new BareClient(server, manfiest);\n}\n"],"names":[],"mappings":"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"}