{"version":3,"file":"osana.client.js","mappings":"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","sources":["webpack://osana/./src/lib/client/element.ts","webpack://osana/./src/lib/client/navigator.ts","webpack://osana/./src/lib/client/style.ts","webpack://osana/webpack/bootstrap","webpack://osana/./src/lib/client/location.ts","webpack://osana/./src/lib/client/storage.ts","webpack://osana/./src/lib/client/window.ts","webpack://osana/./src/lib/client/message.ts","webpack://osana/./src/lib/client/fetch.ts","webpack://osana/./src/lib/client/history.ts","webpack://osana/./src/lib/client/xmlhttp.ts","webpack://osana/./src/lib/client/request.ts","webpack://osana/./src/lib/client/beacon.ts","webpack://osana/./src/lib/client/websocket.ts","webpack://osana/./src/lib/client/eval.ts","webpack://osana/./src/lib/client/worker.ts","webpack://osana/./src/lib/client/open.ts","webpack://osana/./src/lib/client/index.ts"],"sourcesContent":["const rewriteURL = self.__osana$bundle.rewrite.url.rewriteURL;\nconst unwriteURL = self.__osana$bundle.rewrite.url.unwriteURL;\nconst rewriteCSS = self.__osana$bundle.rewrite.css;\nconst rewriteJS = self.__osana$bundle.rewrite.js;\nconst rewriteHTML = self.__osana$bundle.rewrite.html;\nconst rewriteSrcset = self.__osana$bundle.rewrite.srcset;\nconst attributes = {\n    \"href\": [HTMLAnchorElement, HTMLLinkElement, HTMLAreaElement, HTMLBaseElement],\n    \"src\": [HTMLAudioElement, HTMLEmbedElement, HTMLIFrameElement, HTMLImageElement, HTMLInputElement, HTMLScriptElement, HTMLSourceElement, HTMLTrackElement, HTMLVideoElement],\n    \"srcset\": [HTMLImageElement, HTMLSourceElement],\n    \"action\": [HTMLFormElement],\n    \"poster\": [HTMLVideoElement],\n    \"formaction\": [HTMLButtonElement],\n    \"data\": [HTMLObjectElement],\n    \"background\": [HTMLBodyElement],\n    \"integrity\": [HTMLScriptElement, HTMLLinkElement],\n    \"nonce\": [HTMLElement]\n};\n// Element.setAttribute\n// const setterApply = (Object.getOwnPropertyDescriptor(Element.prototype, \"setAttribute\") as any).value;\n// Element.prototype.setAttribute = function (name: string, value: string): void {\n//   if (attributes[name]) {\n//     for (let i in attributes[name]) {\n//       if ((this as any) instanceof attributes[name][i]) {\n//         setterApply.apply(this, [name, rewriteURL(value)]);\n//         return;\n//       }\n//     }\n//   }\n//   if (name === undefined || value === undefined) throw new TypeError(`Failed to execute 'setAttribute' on 'Element': 2 arguments required, but only ${!name && !value ? 0 : 1} present.`);\n//   setterApply.apply(this, [name, value]);\n// }\nHTMLElement.prototype.setAttribute = new Proxy(HTMLElement.prototype.setAttribute, {\n    apply(t, g, a) {\n        if (a[0].toLowerCase() === \"integrity\" || a[0].toLowerCase() === \"nonce\") {\n            g.dataset[`osana_${a[0].toLowerCase}`] = a[0].toLowerCase();\n        }\n        else if (attributes[a[0].toLowerCase()]) {\n            if (a[0].toLowerCase() === \"style\") {\n                g.dataset[\"osana_style\"];\n                a[1] = rewriteCSS(a[1]);\n            }\n            else if (a[0].toLowerCase() === \"srcset\") {\n                g.dataset[\"osana_srcset\"];\n                a[1] = rewriteSrcset(a[1]);\n            }\n            else {\n                g.dataset[`osana_${a[0].toLowerCase()}`];\n                a[1] = rewriteURL(a[1]);\n            }\n        }\n        return Reflect.apply(t, g, a);\n    }\n});\n// TODO: make the getAttribute proxy\n// Element[attribute]\nObject.keys(attributes).forEach((attribute) => {\n    attributes[attribute].forEach((element) => {\n        try {\n            const attr = Object.getOwnPropertyDescriptor(element.prototype, attribute);\n            if (attribute !== \"srcset\") {\n                Object.defineProperty(element.prototype, attribute, {\n                    get() {\n                        return attr.get.call(this, this.dataset[`osana_${attribute}`]);\n                    },\n                    set(value) {\n                        if (attribute === \"integrity\" || attribute === \"nonce\") {\n                            this.dataset[`osana_${attribute}`] = value;\n                            return this.removeAttribute(attribute);\n                        }\n                        else {\n                            this.dataset[`osana_${attribute}`] = value;\n                            return attr.set.call(this, rewriteURL(value));\n                        }\n                    }\n                });\n            }\n            else {\n                Object.defineProperty(element.prototype, attribute, {\n                    get() {\n                        return attr.get.call(this, this.dataset[`osana_${attribute}`]);\n                    },\n                    set(value) {\n                        this.dataset[`osana_${attribute}`] = value;\n                        return attr.set.call(this, rewriteSrcset(value));\n                    },\n                });\n            }\n        }\n        catch (err) {\n            if (err)\n                throw err;\n        }\n    });\n});\n// Element.innerHTML\nconst innerHTML = Object.getOwnPropertyDescriptor(Element.prototype, \"innerHTML\");\nObject.defineProperty(HTMLElement.prototype, \"innerHTML\", {\n    set(value) {\n        if (this instanceof HTMLScriptElement) {\n            return innerHTML.set.call(this, rewriteJS(value));\n        }\n        else if (this instanceof HTMLStyleElement) {\n            return innerHTML.set.call(this, rewriteCSS(value));\n        }\n        return innerHTML.set.call(this, rewriteHTML(value));\n    }\n});\n","Object.defineProperty(navigator, 'serviceWorker', {});\n","const properties = {\n    \"background\": \"background\",\n    \"backgroundImage\": \"background-image\",\n    \"listStyle\": \"list-style\",\n    \"listStyleImage\": \"list-style-image\",\n    \"cursor\": \"cursor\",\n    \"borderImage\": \"border-image\",\n    \"mask\": \"mask\",\n    \"maskImage\": \"mask-image\"\n};\nCSSStyleDeclaration.prototype.setProperty = new Proxy(CSSStyleDeclaration.prototype.setProperty, {\n    apply(t, g, a) {\n        if (a[2] === \"important\" || !a[1]) {\n            return Reflect.apply(t, g, a);\n        }\n        if (Object.values(properties).includes(a[0])) {\n            // i have to use self.__osana$bundle or whatever cuz if i use rewriteCSS name it'll conflict with element.ts\n            return Reflect.apply(t, g, [a[0], self.__osana$bundle.rewrite.css(a[1])]);\n        }\n    }\n});\n// this entire thing needs to be fixed idk why it doesn't work\n// Object.keys(properties).forEach((attr: any) => {\n//   try {\n//     const property = Object.getOwnPropertyDescriptor(CSSStyleDeclaration.prototype, attr) as any;\n//     Object.defineProperty(CSSStyleDeclaration.prototype, attr, {\n//       get () {\n//         return property.get.call(this);\n//       },\n//       set (value) {\n//         return property.set.call(this, self.__osana$bundle.rewrite.css(value));\n//       }\n//     });\n//   } catch (err) {\n//     if (err) throw err;\n//   }\n// });\nconst cssText = Object.getOwnPropertyDescriptor(CSSStyleDeclaration.prototype, \"cssText\");\nObject.defineProperty(CSSStyleDeclaration.prototype, \"cssText\", {\n    set(value) {\n        return cssText.set.call(this, self.__osana$bundle.rewrite.css(value));\n    },\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const config = self.__osana$config;\nexport function getLocation(scope) {\n    try {\n        let fakeLocation = new URL(config.codec.decode(location.pathname.replace(new RegExp(`^${config.prefix}`), \"\")));\n        if (scope) {\n            fakeLocation.href = new URL(config.codec.decode(scope.location.pathname.replace(new RegExp(`^${config.prefix}`), \"\")));\n        }\n        fakeLocation.ancestorOrigins = { length: 0 };\n        fakeLocation.assign = (url) => location.assign(config.prefix + config.codec.encode(url));\n        fakeLocation.reload = () => location.reload();\n        fakeLocation.replace = (url) => location.replace(config.prefix + config.codec.encode(url));\n        fakeLocation.toString = () => fakeLocation.href;\n        return fakeLocation;\n    }\n    catch (_a) {\n        return {};\n    }\n}\nwindow.Location = class {\n};\nexport class LocationProxy {\n    constructor(scope) {\n        return new Proxy(new Location(), {\n            get(target, prop, receiver) {\n                let fakeLocation = getLocation(scope);\n                return fakeLocation[prop];\n            },\n            set(target, prop, value) {\n                let fakeLocation = getLocation(scope);\n                fakeLocation[prop] = value;\n                location.pathname = config.prefix + config.codec.encode(fakeLocation.href);\n                return fakeLocation[prop];\n            }\n        });\n    }\n}\nexport default new LocationProxy();\n","import LocationProxy from \"./location\";\nfunction createStorageProxy(scope) {\n    return new Proxy({\n        getItem(key) {\n            return scope.getItem(`${key}@${LocationProxy.host}`);\n        },\n        setItem(key, value) {\n            scope.setItem(`${key}@${LocationProxy.host}`, value);\n        },\n        removeItem(key) {\n            scope.removeItem(`${key}@${LocationProxy.host}`);\n        },\n        clear() {\n            Object.keys(scope).forEach((key) => {\n                if (new RegExp(`@${LocationProxy.host}$`).test(key)) {\n                    this.removeItem(key.replace(new RegExp(`@${LocationProxy.host}$`), \"\"));\n                }\n            });\n        }\n    }, {\n        get(target, prop, receiver) {\n            if (prop === \"length\") {\n                return Object.keys(scope).filter((key) => new RegExp(`@${LocationProxy.host}$`).test(key)).length;\n            }\n            else if ([\"getItem\", \"setItem\", \"removeItem\", \"clear\"].includes(prop)) {\n                return target[prop];\n            }\n            else {\n                return target.getItem(prop);\n            }\n        },\n        set(target, prop, value) {\n            return target.setItem(prop, value);\n        }\n    });\n}\nconst idbopen = indexedDB.open;\nindexedDB.open = (name, version) => {\n    return idbopen.call(indexedDB, `${name}@${LocationProxy.host}`, version);\n};\nif (window.hasOwnProperty(\"openDatabase\")) {\n    const odb = openDatabase;\n    openDatabase = (name, version, displayName, maxSize) => {\n        return odb(`${name}@${LocationProxy.host}`, version, displayName, maxSize);\n    };\n}\nwindow.__localStorage = createStorageProxy(localStorage);\nwindow.__sessionStorage = createStorageProxy(sessionStorage);\n","import { LocationProxy } from \"./location\";\nexport class WindowProxy {\n    constructor(scope) {\n        return new Proxy(scope, {\n            get(target, prop, receiver) {\n                if (prop === \"location\") {\n                    return new LocationProxy(target);\n                }\n                else if ([\"parent\", \"top\"].includes(prop)) {\n                    if (window === window[prop])\n                        return window.__window;\n                    else\n                        return new WindowProxy(target[prop]);\n                }\n                else if ([\"window\", \"self\", \"globalThis\"].includes(prop)) {\n                    return new WindowProxy(target);\n                }\n                else if (prop === \"localStorage\") {\n                    return window.__localStorage;\n                }\n                else if (prop === \"sessionStorage\") {\n                    return window.__sessionStorage;\n                }\n                return target[prop];\n            },\n            set(target, prop, value) {\n                return Reflect.set(scope, prop, value);\n            }\n        });\n    }\n}\nexport default new WindowProxy(window);\n","import { WindowProxy } from \"./window\";\nexport default class MessageProxy {\n    constructor(scope) {\n        return new Proxy(scope.addEventListener, {\n            apply(target, thisArg, args) {\n                if (args[0] && args[1]) {\n                    if (args[0] === \"message\") {\n                        args[1] = new Proxy(args[1], {\n                            apply(target, thisArg, args) {\n                                args[0] = new Proxy(args[0], {\n                                    get(target, prop, receiver) {\n                                        if (prop === \"origin\")\n                                            return __location.origin;\n                                        if (prop === \"path\")\n                                            target[prop].map((win) => new WindowProxy(win));\n                                        if (prop === \"currentTarget\")\n                                            return new WindowProxy(target[prop]);\n                                        if (prop === \"source\")\n                                            return new WindowProxy(target[prop]);\n                                        if (prop === \"srcElement\")\n                                            return new WindowProxy(target[prop]);\n                                        if (prop === \"target\")\n                                            return new WindowProxy(target[prop]);\n                                        return target[prop];\n                                    }\n                                });\n                                return Reflect.apply(target, thisArg, args);\n                            }\n                        });\n                    }\n                }\n                return Reflect.apply(target, thisArg, args);\n            }\n        });\n    }\n}\n","const rewriteURL = self.__osana$bundle.rewrite.url.rewriteURL;\nexport default new Proxy(fetch, {\n    apply(target, thisArg, args) {\n        if (args[0])\n            args[0] = rewriteURL(args[0]);\n        return Reflect.apply(target, thisArg, args);\n    }\n});\n","const rewriteURL = self.__osana$bundle.rewrite.url.rewriteURL;\nconst config = self.__osana$config;\nconst pushState = new Proxy(window.history.pushState, {\n    apply(target, thisArg, args) {\n        if (new RegExp(`^${config.prefix}`).test(args[2]))\n            return;\n        args[2] = rewriteURL(args[2]);\n        Reflect.apply(target, thisArg, args);\n    }\n});\nconst replaceState = new Proxy(window.history.replaceState, {\n    apply(target, thisArg, args) {\n        if (new RegExp(`^${config.prefix}`).test(args[2]))\n            return;\n        args[2] = rewriteURL(args[2]);\n        Reflect.apply(target, thisArg, args);\n    }\n});\nexport { pushState, replaceState };\n","const rewriteURL = self.__osana$bundle.rewrite.url.rewriteURL;\nconst XMLOpen = window.XMLHttpRequest.prototype.open;\nexport default function (...args) {\n    if (args[1])\n        args[1] = rewriteURL(args[1]);\n    return XMLOpen.call(this, ...args);\n}\n;\n","const rewriteURL = self.__osana$bundle.rewrite.url.rewriteURL;\nconst config = self.__osana$config;\nexport default new Proxy(Request, {\n    construct(target, args) {\n        if (args[0])\n            args[0] = rewriteURL(args[0]);\n        return new Proxy(Reflect.construct(target, args), {\n            get(target, prop, receiver) {\n                if (prop === \"url\") {\n                    let fakeLocation = new URL(config.codec.decode(location.pathname.replace(new RegExp(`^${config.prefix}`), \"\")));\n                    return fakeLocation.href;\n                }\n                return target[prop];\n            }\n        });\n    }\n});\n","const rewriteURL = self.__osana$bundle.rewrite.url.rewriteURL;\nexport default new Proxy(navigator.sendBeacon, {\n    apply(target, thisArg, args) {\n        if (args[0])\n            args[0] = rewriteURL(args[0]);\n        return Reflect.apply(target, thisArg, args);\n    }\n});\n","import locationProxy from \"./location\";\nconst encodeProtocol = self.__osana$bundle.rewrite.protocol;\nconst v4 = self.__osana$bundle.uuid;\nconst config = self.__osana$config;\nconst websockets = new Map();\nexport default new Proxy(WebSocket, {\n    construct(target, args, newTarget) {\n        if (args[0]) {\n            const url = new URL(args[0]);\n            const id = v4();\n            websockets.set(id, url.toString());\n            const request = {\n                remote: {\n                    host: url.hostname,\n                    port: url.port || (url.protocol === \"wss:\" ? \"443\" : \"80\"),\n                    path: url.pathname + url.search,\n                    protocol: url.protocol\n                },\n                headers: {\n                    Host: url.host,\n                    Origin: locationProxy.origin,\n                    Pragma: \"no-cache\",\n                    \"Cache-Control\": \"no-cache\",\n                    Upgrade: \"websocket\",\n                    Connection: \"Upgrade\"\n                },\n                forward_headers: [\"accept-encoding\", \"accept-language\", \"sec-websocket-extensions\", \"sec-websocket-key\", \"sec-websocket-version\"]\n            };\n            const bareURL = new URL(config.bare);\n            return Reflect.construct(target, [location.protocol.replace(\"http\", \"ws\") + \"//\" + (bareURL.host + bareURL.pathname) + `v1/?${id}`, [\"bare\", encodeProtocol(JSON.stringify(request))]]);\n        }\n        return Reflect.construct(target, args, newTarget);\n    }\n});\nconst websocketURL = Object.getOwnPropertyDescriptor(WebSocket.prototype, \"url\");\nObject.defineProperty(WebSocket.prototype, \"url\", {\n    get() {\n        const url = websocketURL.get.call(this);\n        const id = new URL(url).search.substring(1);\n        return websockets.get(id);\n    }\n});\n","const rewriteJS = self.__osana$bundle.rewrite.js;\nexport default new Proxy(eval, {\n    apply(target, thisArg, argumentsList) {\n        if (argumentsList[0])\n            argumentsList[0] = rewriteJS(argumentsList[0]);\n        return Reflect.apply(target, thisArg, argumentsList);\n    }\n});\n","const rewriteURL = self.__osana$bundle.rewrite.url.rewriteURL;\nexport default new Proxy(window.Worker, {\n    construct(target, args, newTarget) {\n        if (args[0])\n            args[0] = rewriteURL(args[0]);\n        return Reflect.construct(target, args, newTarget);\n    }\n});\n","const rewriteURL = self.__osana$bundle.rewrite.url.rewriteURL;\nexport default new Proxy(window.open, {\n    apply(target, thisArg, args) {\n        if (args[0] && args[0] !== \"about:blank\")\n            args[0] = rewriteURL(args[0]);\n        Reflect.apply(target, thisArg, args);\n    }\n});\n","import \"./element\";\nimport \"./style\";\nimport \"./storage\";\nimport \"./navigator\";\nimport * as MessageProxy from \"./message\";\nimport FetchProxy from \"./fetch\";\nimport * as History from \"./history\";\nimport LocationProxy from \"./location\";\nimport WindowProxy from \"./window\";\nimport XMLHttpRequestProxy from \"./xmlhttp\";\nimport RequestProxy from \"./request\";\nimport BeaconProxy from \"./beacon\";\nimport WebSocketProxy from \"./websocket\";\nimport EvalProxy from \"./eval\";\nimport WorkerProxy from \"./worker\";\nimport OpenProxy from \"./open\";\nwindow.fetch = FetchProxy;\nwindow.Request = RequestProxy;\nwindow.history.pushState = History.pushState;\nwindow.history.replaceState = History.replaceState;\nwindow.__parent = WindowProxy;\nwindow.__location = LocationProxy;\nwindow.__window = WindowProxy;\nwindow.__self = WindowProxy;\nwindow.__top = WindowProxy;\nwindow.XMLHttpRequest.prototype.open = XMLHttpRequestProxy;\nnavigator.sendBeacon = BeaconProxy;\nwindow.WebSocket = WebSocketProxy;\nwindow.eval = EvalProxy;\nwindow.Worker = WorkerProxy;\nwindow.open = OpenProxy;\nwindow.addEventListener = new MessageProxy.default(window);\nwindow.Worker.prototype.addEventListener = new MessageProxy.default(window.Worker.prototype);\n"],"names":["rewriteURL","self","__osana$bundle","rewrite","url","rewriteCSS","unwriteURL","css","rewriteJS","js","rewriteHTML","html","rewriteSrcset","srcset","attributes","HTMLAnchorElement","HTMLLinkElement","HTMLAreaElement","HTMLBaseElement","HTMLAudioElement","HTMLEmbedElement","HTMLIFrameElement","HTMLImageElement","HTMLInputElement","HTMLScriptElement","HTMLSourceElement","HTMLTrackElement","HTMLVideoElement","HTMLFormElement","HTMLButtonElement","HTMLObjectElement","HTMLBodyElement","HTMLElement","prototype","setAttribute","Proxy","apply","t","g","a","toLowerCase","dataset","Reflect","Object","keys","forEach","attribute","element","attr","getOwnPropertyDescriptor","defineProperty","get","call","this","set","value","removeAttribute","err","innerHTML","Element","HTMLStyleElement","navigator","properties","CSSStyleDeclaration","setProperty","values","includes","cssText","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","config","__osana$config","getLocation","scope","fakeLocation","URL","codec","decode","location","pathname","replace","RegExp","prefix","href","ancestorOrigins","length","assign","encode","reload","toString","_a","window","Location","LocationProxy","constructor","target","prop","receiver","createStorageProxy","getItem","key","setItem","removeItem","clear","test","filter","idbopen","indexedDB","open","name","version","hasOwnProperty","odb","openDatabase","displayName","maxSize","__localStorage","localStorage","__sessionStorage","sessionStorage","WindowProxy","__window","MessageProxy","addEventListener","thisArg","args","__location","origin","map","win","fetch","pushState","history","replaceState","XMLOpen","XMLHttpRequest","Request","construct","sendBeacon","encodeProtocol","protocol","v4","uuid","websockets","Map","WebSocket","newTarget","id","request","remote","host","hostname","port","path","search","headers","Host","Origin","Pragma","Upgrade","Connection","forward_headers","bareURL","bare","JSON","stringify","websocketURL","substring","eval","argumentsList","Worker","__parent","__self","__top"],"sourceRoot":""}